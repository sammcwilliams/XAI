

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Local Interpretable Model Explanation (LIME) &mdash; XAI 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/black_box.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Partial Dependence Plots (PDP)" href="pdp.html" />
    <link rel="prev" title="Ceteris Paribus" href="cetpar.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> XAI
          

          
            
            <img src="_static/raa-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#initialisation">Initialisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="featimp.html">Feature Importance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#requisites">Requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#accepted-data">Accepted Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#accepted-models">Accepted Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#dimensionality">Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#caveats">Caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="featimp.html#output-interpretation">Output interpretation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shapley.html">Shapley Values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="shapley.html#calculation">Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="shapley.html#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#requisites">Requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#accepted-data">Accepted Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#accepted-models">Accepted Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#dimensionality">Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#caveats">Caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="shapley.html#output-interpretation">Output interpretation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="surrogate.html">Global Surrogate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#requisites">Requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#accepted-data">Accepted Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#accepted-models">Accepted Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#dimensionality">Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#caveats">Caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="surrogate.html#output-interpretation">Output interpretation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cetpar.html">Ceteris Paribus</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cetpar.html#nearest-neighbour">Nearest Neighbour</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#requisites">Requisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#accepted-data">Accepted Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#accepted-models">Accepted Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#dimensionality">Dimensionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#caveats">Caveats</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#output-interpretation">Output interpretation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cetpar.html#plot-instances-per-feature-ice">Plot instances per feature (ICE)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id1">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id2">Requisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id3">Accepted Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id4">Accepted Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id5">Dimensionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id6">Caveats</a></li>
<li class="toctree-l3"><a class="reference internal" href="cetpar.html#id7">Output interpretation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Local Interpretable Model Explanation (LIME)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#requisites">Requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#accepted-models-data">Accepted Models/Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#models">Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data">Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dimensionality">Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#caveats">Caveats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-s-local">What’s Local?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inconsistency">Inconsistency</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#output-interpretation">Output interpretation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pdp.html">Partial Dependence Plots (PDP)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pdp.html#usage">Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#one-feature">One Feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#two-features">Two Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pdp.html#requisites">Requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdp.html#accepted-models-data">Accepted Models/Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#data">Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#models">Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pdp.html#dimensionality">Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="pdp.html#caveats">Caveats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#correlation">Correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#average-dangerous">Average == Dangerous</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#feature-distribution">Feature Distribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pdp.html#output-interpretation">Output interpretation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#id1">One feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="pdp.html#id2">Two features</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="anch.html">Anchors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="anch.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="anch.html#requisites">Requisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="anch.html#accepted-data">Accepted Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="anch.html#accepted-models">Accepted Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="anch.html#dimensionality">Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="anch.html#caveats">Caveats</a></li>
<li class="toctree-l2"><a class="reference internal" href="anch.html#output-interpretation">Output interpretation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="summaries.html">Summaries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="summaries.html#summarising-an-instance">Summarising an instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="summaries.html#summarising-a-feature">Summarising a feature</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">XAI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Local Interpretable Model Explanation (LIME)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lime.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="local-interpretable-model-explanation-lime">
<h1>Local Interpretable Model Explanation (LIME)<a class="headerlink" href="#local-interpretable-model-explanation-lime" title="Permalink to this headline">¶</a></h1>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>This approach in essence takes the instance passed to it, perturbs each feature such that it explores the local feature space
and learns a linear model around this area. It is important to note that the explanations it gives for values that a feature takes, can only be valid when all the other values stay somewhat similar.</p>
<p>Simply pass a 1D array to the following function, along with an optional filename to export the explanation and a class to associate the explanation with. By default, the plot_class variable
takes the value -1 and thus will use the predict function of the model to choose a class to explain the instance with.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xai</span><span class="o">.</span><span class="n">lime</span><span class="o">.</span><span class="n">tabular_explanation</span><span class="p">(</span><span class="n">test_x</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;lime_explanation.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Below is the plot of the local model’s effects, with this example indicating that the feature “sepal_width (cm)” has a negative
effect on the prediction of Class 1, while the rest of the features have a positive effect. Interpreted in terms of the local model itself,
the weight associated with “sepal_width (cm)” will be negative, while the others positive.</p>
<p>The ranges that are given with the features define the local area in feature space that the local model is working in.</p>
<div class="figure align-center" id="id1">
<img alt="_images/doc_lime.png" src="_images/doc_lime.png" />
<p class="caption"><span class="caption-text">Figure 1: Plot of the instance’s approximate local effects of each feature.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="requisites">
<h2>Requisites<a class="headerlink" href="#requisites" title="Permalink to this headline">¶</a></h2>
<p>The model’s predict function is required, as well as the training data. The training data is only required to calculate the mean and standard deviation by which to perturb the features
to get the neighbourhood. On top of this is the instance to be explained.</p>
</div>
<div class="section" id="accepted-models-data">
<h2>Accepted Models/Data<a class="headerlink" href="#accepted-models-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="models">
<h3>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h3>
<p>The underlying LIME package takes the model’s predict function as a parameter, meaning that theoretically this technique can work with any model.</p>
</div>
<div class="section" id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h3>
<p>LIME currently supports tabular data, text and also images.</p>
<p>In regards to tabular data, the LIME subpackage recognises:</p>
<ul class="simple">
<li><p>Categorical data. This needs to be specified as a parameter to the function.</p></li>
<li><p>Numerical data. This is the default type and is used unless specified otherwise.</p></li>
</ul>
</div>
</div>
<div class="section" id="dimensionality">
<h2>Dimensionality<a class="headerlink" href="#dimensionality" title="Permalink to this headline">¶</a></h2>
<p>blah blah blah (is this section needed??)</p>
</div>
<div class="section" id="caveats">
<h2>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-s-local">
<h3>What’s Local?<a class="headerlink" href="#what-s-local" title="Permalink to this headline">¶</a></h3>
<p>As explained below †, due to the difficulty of defining the decision boundary, the effectiveness of the resultant explanation is mostly unknown. Baked into this problem is the issue of how large to make the neighbourhood, as the orientation of the
local linear model depends on it highly.</p>
<dl class="simple">
<dt>In addition to this, the current version of LIME samples the neighbourhood using a Gaussian distribution, meaning that the real distribution defined by the correlation between the features is ignored</dt><dd><ul class="simple">
<li><p>thus creating a neighbourhood with instances outside of the actual “catchment area”.</p></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="inconsistency">
<h3>Inconsistency<a class="headerlink" href="#inconsistency" title="Permalink to this headline">¶</a></h3>
<p>It was shown by the authors of the paper that very similar instances resulted in drastically different local explanations. This lack of consistency definitionally cannot provide explanations to be relied on without
substantiation from other explainability methods.</p>
</div>
</div>
<div class="section" id="output-interpretation">
<h2>Output interpretation<a class="headerlink" href="#output-interpretation" title="Permalink to this headline">¶</a></h2>
<p>The explanation returned and plotted by the LIME algorithm is essentially the hyperparameters for a linear model. In linear models, the size of the weight indicates the size of the contribution towards the prediction
and the sign of the weight tells you whether it increases or decreases the value of the prediction.</p>
<p>In the example below (adapted from the LIME paper itself) you can see two different classes, which are represented by the different colours. The big red plus is the instance to be explored, with the remaining pluses being other instances
of the same class, and the blue dots belonging to the other class. The algorithm then uses this root instance’s neighbours to define the local area, with more proximal instances (the larger ones) having a larger influence.
Using this information the algorithm outputs the dotted line as an explanation of the model in that specific region of the feature space - defining left of the line as ‘red’ and right as ‘blue. This is clearly globally inaccurate as we can see ‘blue’
instances way to the left of the line.</p>
<p>† To illustrate the limitations of this approach, I have added an instance to the diagram below in the shape of a red asterix. Should this have been selected as the instance to be explained, and even granting that the neighbourhood of said
instance was densely populated, it is safe to say the likely explanation LIME would output, would categorically be a less useful explanation. This is because in the original example, the actual decision boundary is a straight line
for an extent, meaning the linear explanation is correct for a larger segment of the feature space. The reason this is problematic is because the actual decision boundary is next to impossible to define, meaning it’s very difficult to tell the difference
between a widely applicable explanation, and a narrow and effectively useless one.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/lime_vis.png"><img alt="_images/lime_vis.png" src="_images/lime_vis.png" style="width: 349.5px; height: 222.0px;" /></a>
<p class="caption"><span class="caption-text">Visualisation of the LIME algorithm in a simplified feature space.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pdp.html" class="btn btn-neutral float-right" title="Partial Dependence Plots (PDP)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cetpar.html" class="btn btn-neutral float-left" title="Ceteris Paribus" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sam McWilliams

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>